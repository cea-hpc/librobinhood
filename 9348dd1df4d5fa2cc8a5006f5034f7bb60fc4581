{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f9fabb62_4e5465c1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1018755
      },
      "writtenOn": "2021-10-23T09:55:31Z",
      "side": 1,
      "message": "I didn\u0027t test this patch very extensively, but it did work at least once on an entry that had one user xattr.",
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5cfb807f_52107099",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2021-10-25T13:01:59Z",
      "side": 1,
      "message": "This patch indeed does not work for multiple xattrs :\n\n[valeriy@vm0 ~]$ mkdir test\n[valeriy@vm0 ~]$ touch test/a\n[valeriy@vm0 ~]$ setfattr -n user.a -v b test/a \n[valeriy@vm0 ~]$ setfattr -n user.b -v c test/a \n[valeriy@vm0 ~]$ setfattr -n user.c -v d test/a \n[valeriy@vm0 ~]$ rbh-sync rbh:posix:test/ rbh:mongo:test\nSegmentation fault (core dumped)\n\nI haven\u0027t checked yet why or how it crashes unfortunately.",
      "parentUuid": "f9fabb62_4e5465c1",
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f7c32c2a_af051aad",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1018755
      },
      "writtenOn": "2021-10-25T18:36:27Z",
      "side": 1,
      "message": "I thought getxattr(2) would write a null terminating byte at the end of `value` for me, but it doesn\u0027t, which sort of makes sense if one wants to store binary data in a symbolic link (some people just want to watch the world burn).\n\nThen it makes more sense to store extended attributes as binary data in fsentries rather than strings.",
      "parentUuid": "5cfb807f_52107099",
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2b7ff48c_5de6c717",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2021-10-26T10:34:35Z",
      "side": 1,
      "message": "This unfortunately still does not fix the segfault when a file has multiple xattrs.\nThe issue seems to be linked with the value sstack, most likely an overflow at some point, but I can\u0027t determine the root of the problem...",
      "parentUuid": "f7c32c2a_af051aad",
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "076e747b_76ff20cf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1018755
      },
      "writtenOn": "2021-11-03T23:00:09Z",
      "side": 1,
      "message": "Done (still didn\u0027t test the patch much more than 2 xattrs)",
      "parentUuid": "2b7ff48c_5de6c717",
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2592dc98_9bbb6505",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 472,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2021-10-25T13:01:59Z",
      "side": 1,
      "message": "defect: I\u0027m testing this patch and there is an issue on the result in the case of a singular xattrs.\n\n[valeriy@vm0 ~]$ mkdir test\n[valeriy@vm0 ~]$ touch test/a\n[valeriy@vm0 ~]$ setfattr -n user.a -v b test/a \n[valeriy@vm0 ~]$ rbh-sync rbh:posix:test/ rbh:mongo:test\n\n\u003e use test\nswitched to db test\n\u003e db.entries.find()\n{ \"_id\" : BinData(0,\"gQAAAKoXDgAAAAAAvVl2xg\u003d\u003d\"), \"statx\" : { \"blksize\" : 4096, \"nlink\" : 2, \"uid\" : 1005, \"gid\" : 1005, \"type\" : 16384, \"mode\" : 509, \"ino\" : NumberLong(923562), \"size\" : NumberLong(15), \"blocks\" : NumberLong(0), \"attributes\" : { \"immutable\" : false, \"append\" : false, \"nodump\" : false }, \"atime\" : { \"sec\" : NumberLong(1635166316), \"nsec\" : 708838795 }, \"btime\" : { \"sec\" : NumberLong(1635166301), \"nsec\" : 718838795 }, \"ctime\" : { \"sec\" : NumberLong(1635166304), \"nsec\" : 422838795 }, \"mtime\" : { \"sec\" : NumberLong(1635166304), \"nsec\" : 422838795 }, \"rdev\" : { \"major\" : 0, \"minor\" : 0 }, \"dev\" : { \"major\" : 252, \"minor\" : 1 } }, \"ns\" : [ { \"parent\" : BinData(0,\"\"), \"name\" : \"\", \"xattrs\" : {  } } ] }\n{ \"_id\" : BinData(0,\"gQAAAKsXDgAAAAAAAbG91w\u003d\u003d\"), \"statx\" : { \"blksize\" : 4096, \"nlink\" : 1, \"uid\" : 1005, \"gid\" : 1005, \"type\" : 32768, \"mode\" : 436, \"ino\" : NumberLong(923563), \"size\" : NumberLong(0), \"blocks\" : NumberLong(0), \"attributes\" : { \"immutable\" : false, \"append\" : false, \"nodump\" : false }, \"atime\" : { \"sec\" : NumberLong(1635166304), \"nsec\" : 422838795 }, \"btime\" : { \"sec\" : NumberLong(1635166304), \"nsec\" : 422838795 }, \"ctime\" : { \"sec\" : NumberLong(1635166317), \"nsec\" : 253838795 }, \"mtime\" : { \"sec\" : NumberLong(1635166304), \"nsec\" : 422838795 }, \"rdev\" : { \"major\" : 0, \"minor\" : 0 }, \"dev\" : { \"major\" : 252, \"minor\" : 1 } }, \"xattrs\" : { \"user\" : { \"a\" : \"b\" } }, \"ns\" : [ { \"parent\" : BinData(0,\"gQAAAKoXDgAAAAAAvVl2xg\u003d\u003d\"), \"name\" : \"a\", \"xattrs\" : { \"user.a\" : \"b\" } } ] }\n\nAs you can see, in the mongo output of the database, the inode XATTRS are duplicated, both in the \u0027inode\u0027 field (simply called \u0027xattrs\u0027), and in the \u0027ns\u0027 field.",
      "range": {
        "startLine": 470,
        "startChar": 4,
        "endLine": 472,
        "endChar": 54
      },
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4d42e343_2f4dacfb",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 472,
      "author": {
        "id": 1018755
      },
      "writtenOn": "2021-10-25T18:36:27Z",
      "side": 1,
      "message": "This isn\u0027t this patch\u0027s fault. That\u0027s a bug in rbh-sync.",
      "parentUuid": "2592dc98_9bbb6505",
      "range": {
        "startLine": 470,
        "startChar": 4,
        "endLine": 472,
        "endChar": 54
      },
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "62cbe99b_cd0e5078",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 472,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2021-10-26T10:34:35Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4d42e343_2f4dacfb",
      "range": {
        "startLine": 470,
        "startChar": 4,
        "endLine": 472,
        "endChar": 54
      },
      "revId": "9348dd1df4d5fa2cc8a5006f5034f7bb60fc4581",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}