{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "9fbf740f_6bbdeebc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2021-11-04T09:16:04Z",
      "side": 1,
      "message": "Yep, problem fixed for 2 or more xattrs!\nThanks for the patch ðŸ˜Š",
      "revId": "4be1781e551d87795bb6a3a5cf2b6ee1addfcf43",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "99da73e0_74bbf8f7",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2021-11-04T09:32:27Z",
      "side": 1,
      "message": "question: why use a sstack here for values and xattrs ?",
      "range": {
        "startLine": 25,
        "startChar": 20,
        "endLine": 25,
        "endChar": 29
      },
      "revId": "4be1781e551d87795bb6a3a5cf2b6ee1addfcf43",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "18b2014d_996d2a69",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1018755
      },
      "writtenOn": "2021-11-04T20:43:16Z",
      "side": 1,
      "message": "I am not sure I understand the question.\n\nWhy do I need to store values and xattrs? Because I cannot store an unbounded amount of information on the stack.\n\nWhy an sstack and not something else? What would that something else be?\n\n- A regular buffer? I find sstack to be more convenient. I don\u0027t have to deal with the constant resizing.\n- An rring? Because I don\u0027t need the circularity, and I would have to use a base size which is a multiple of the running kernel\u0027s page. So convience as well.",
      "parentUuid": "99da73e0_74bbf8f7",
      "range": {
        "startLine": 25,
        "startChar": 20,
        "endLine": 25,
        "endChar": 29
      },
      "revId": "4be1781e551d87795bb6a3a5cf2b6ee1addfcf43",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c77947e3_4a658a3c",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2021-11-05T07:39:42Z",
      "side": 1,
      "message": "It was the second question, wanted to understand why you chose a structure like this, and not another one, and you answer it perfectly, thanks ðŸ˜Š",
      "parentUuid": "18b2014d_996d2a69",
      "range": {
        "startLine": 25,
        "startChar": 20,
        "endLine": 25,
        "endChar": 29
      },
      "revId": "4be1781e551d87795bb6a3a5cf2b6ee1addfcf43",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27a2151a_0cdf6484",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 5
      },
      "lineNbr": 177,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2021-11-04T13:32:56Z",
      "side": 1,
      "message": "suggest: this may be a small optimization but we could compare the ceil2 value of length and buflen. As long as the ceil2 value is greater that buflen, we have to reallocate.",
      "range": {
        "startLine": 177,
        "startChar": 16,
        "endLine": 177,
        "endChar": 32
      },
      "revId": "4be1781e551d87795bb6a3a5cf2b6ee1addfcf43",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "187b6fa3_93042de3",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 5
      },
      "lineNbr": 177,
      "author": {
        "id": 1018755
      },
      "writtenOn": "2021-11-04T20:43:16Z",
      "side": 1,
      "message": "Can you share a snippet of what you have in mind? The way I understand it is:\n\n if (ceil2(length) \u003e buflen) {\n     tmp \u003d realloc(keys, ceil2(length));\n     if (tmp \u003d\u003d NULL)\n         return -1;\n     *buffer \u003d keys \u003d tmp;\n     *size \u003d buflen \u003d ceil2(length);\n }\n goto retry;\n\nIn which case: how does this improve performance? That rewrite is in the realm of what a compiler should be able to optimize without any issues, and it is less clear that `ceil2(length)` might actually be lower or equal to `buflen`, and why.",
      "parentUuid": "27a2151a_0cdf6484",
      "range": {
        "startLine": 177,
        "startChar": 16,
        "endLine": 177,
        "endChar": 32
      },
      "revId": "4be1781e551d87795bb6a3a5cf2b6ee1addfcf43",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7f52ee6c_c6de888b",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 5
      },
      "lineNbr": 177,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2021-11-05T07:57:05Z",
      "side": 1,
      "message": "What I was suggesting was:\n\nif (ceil2(length) \u003c\u003d buflen)\n    goto retry:\n\nBut I think I understood your code incorrectly. I though that the retry was to avoid reallocating the buffer. But if length has changed it means that the keys have changed as well so you need to fetch them again. I thought we could avoid the third flistxattr. My bad.",
      "parentUuid": "187b6fa3_93042de3",
      "range": {
        "startLine": 177,
        "startChar": 16,
        "endLine": 177,
        "endChar": 32
      },
      "revId": "4be1781e551d87795bb6a3a5cf2b6ee1addfcf43",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}