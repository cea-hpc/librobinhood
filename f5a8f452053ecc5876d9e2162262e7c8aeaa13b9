{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f5bfca87_f3ab1cc2",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2022-06-24T21:11:33Z",
      "side": 1,
      "message": "ugh, lustre also needs that :(",
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fdf9da72_21dda1be",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2022-06-28T11:39:39Z",
      "side": 1,
      "message": "typo?: on which the file is stored ?",
      "range": {
        "startLine": 22,
        "startChar": 53,
        "endLine": 23,
        "endChar": 14
      },
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eae219ff_603cab39",
        "filename": "src/backends/lustre/lustre.c",
        "patchSetId": 2
      },
      "lineNbr": 706,
      "author": {
        "id": 1019142
      },
      "writtenOn": "2022-06-28T11:39:39Z",
      "side": 1,
      "message": "suggest: I feel like it would be better to just pass the mode to each function instead of multiplying the global variables...",
      "range": {
        "startLine": 706,
        "startChar": 4,
        "endLine": 706,
        "endChar": 31
      },
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5f552fc_821c5f32",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2022-06-24T21:11:33Z",
      "side": 1,
      "message": "since you have the is_symlink info, base the decision on that instead?\nafaik ELOOP will always happen on symlinks open with O_NOFOLLOW and should never happen on anything else.",
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4531368f_d27b2e36",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2022-06-27T07:43:43Z",
      "side": 1,
      "message": "What do you mean by \"is_symlink info\" ? This is the first open, so we don\u0027t know what the file yet ?\nYes a symlink opened with NOFOLLOW will always fail with ELOOP, that\u0027s the goal of this check",
      "parentUuid": "a5f552fc_821c5f32",
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "18d9ad81_cdc4fa45",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2022-06-27T08:19:45Z",
      "side": 1,
      "message": "eh, I was a bit confused with the is_symlink from the other file, but we have the info right here in (ftsent-\u003efts_info \u0026 FTS_SL).\n\nNot tested but this is code path for fts, and getdents give the info, and fts uses it so I sure hope it\u0027s filled in...",
      "parentUuid": "4531368f_d27b2e36",
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3e6a3597_32ca6601",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2022-06-28T10:51:34Z",
      "side": 1,
      "message": "I tried it, but it does not work, and after adding a print of the info just before the open, I get the following:\n\n```\nmkdir tmp\ntouch tmp/a\nln -s /mnt/lustre/tmp/a tmp/b\nln -s blob tmp/c\n\n[valeriy@vm0 lustre]$ sudo rbh-sync rbh:lustre:tmp/ rbh:mongo:test666\n../src/backends/posix/posix.c, 359\n../src/backends/posix/posix.c, 361, file \u003d tmp\n../src/backends/posix/posix.c, 363, info \u003d 1\n../src/backends/posix/posix.c, 359\n../src/backends/posix/posix.c, 361, file \u003d tmp\n../src/backends/posix/posix.c, 363, info \u003d 1\n../src/backends/posix/posix.c, 359\n../src/backends/posix/posix.c, 361, file \u003d c\n../src/backends/posix/posix.c, 363, info \u003d 11\n../src/backends/posix/posix.c, 359\n../src/backends/posix/posix.c, 361, file \u003d a\n../src/backends/posix/posix.c, 363, info \u003d 11\n../src/backends/posix/posix.c, 359\n../src/backends/posix/posix.c, 361, file \u003d b\n../src/backends/posix/posix.c, 363, info \u003d 11\n\n```\n\nAnd after checking, I don\u0027t see a modification of this fts_info, so neither a valid symbolic link or an invalid one are marked as such after a fts_read on the posix iterator...",
      "parentUuid": "18d9ad81_cdc4fa45",
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "85239ad5_1fa6dd62",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2022-06-28T11:15:39Z",
      "side": 1,
      "message": "Looking at the fts code that is because we call fts_open with FTS_NOSTAT. Sorry I didn\u0027t notice.\n\nDespite the name removing the flag doesn\u0027t make fts do an actual stat syscall, but it makes a slightly bigger allocation for each ftsent: given we don\u0027t expect so many symlinks I\u0027m not sure it\u0027ll make a huge difference either way  -- leaving this decision to you (it\u0027d definitely be faster if we have a significant number of symlinks though)",
      "parentUuid": "3e6a3597_32ca6601",
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "540b48d0_e3e14c06",
        "filename": "src/backends/posix/posix.c",
        "patchSetId": 2
      },
      "lineNbr": 360,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2022-06-28T11:32:54Z",
      "side": 1,
      "message": "I don\u0027t think we\u0027ll deal with that many symlinks, so hindering the whole process just to remove one call to open is useless IMO.",
      "parentUuid": "85239ad5_1fa6dd62",
      "revId": "f5a8f452053ecc5876d9e2162262e7c8aeaa13b9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}